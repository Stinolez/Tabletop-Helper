"use strict";let app=function(){let appName="Tabletop Helper",appVersion="25.08.17.183110",appOwner="Tomáš 'Stínolez' Vitásek",loader=document.querySelector(".loader");function createElement(elementType,data){let element=document.createElement(elementType);switch(elementType){case"div":case"span":case"tr":case"td":case"li":element.className=data[0],element.innerHTML=data[1];break;case"ul":case"ol":let listData=data[1];element.className=data[0];for(let i=0;i<listData.length;i++){let sub;sub="cardTable"===listData[i][0]?createElement("table",listData[i]):createElement("li",listData[i]),element.appendChild(sub)}break;case"table":let tableData=data[1];element.className=data[0];for(let i=0;i<tableData.length;i++){let row=createElement("tr",["",""]);for(let j=0;j<tableData[i].length;j++){let col=createElement("td",["",tableData[i][j]]);row.appendChild(col)}element.appendChild(row)}break;case"img":let imgAttributes=JSON.parse(data[1]);element.className=data[0];for(let attr in imgAttributes)-1===attr.indexOf("data-")?element[attr]=imgAttributes[attr]:element.dataset[attr.replace("data-","")]=imgAttributes[attr]}return element}function showLoader(){loader.hidden=!1}function hideLoader(){loader.hidden=!0}function loadFile(callback,filepath,type){let xobj=new XMLHttpRequest;switch(type){case"json":xobj.overrideMimeType("application/json");break;case"md":xobj.overrideMimeType("text/markdown");break;default:xobj.overrideMimeType("text/plain")}xobj.open("GET",filepath,!0),xobj.onreadystatechange=function(){4==xobj.readyState&&"200"==xobj.status&&callback(xobj.responseText)},xobj.send(null)}function releaseNotes(json){let data=JSON.parse(json),rn=document.getElementById("release-notes");for(let versions in data){let card=createElement("div",["card",""]),cardTitle=createElement("div",["cardTitle","Version "+versions+" ("+data[versions].date+")"]),rnList=createElement("ul",["rn",data[versions].rn]);card.appendChild(cardTitle),card.appendChild(rnList),rn.appendChild(card)}}function registerGames(json){let data=JSON.parse(json),games=document.getElementById("games"),settings=JSON.parse(localStorage.getItem("game-visibility")||"{}");for(let game in data)if(!1!==settings[game]){let gameData={src:"images/games-logo/"+game+".png",alt:data[game].name,"data-game":game,"data-gamename":data[game].search},card=createElement("div",["card",""]),img=createElement("img",["cardLogo",JSON.stringify(gameData)]);card.appendChild(img),games.appendChild(card)}if(document.getElementsByClassName("cardLogo").length>0)for(let i=0;i<document.getElementsByClassName("cardLogo").length;i++)document.getElementsByClassName("cardLogo")[i].addEventListener("click",(function(e){location.href="games/g_"+e.target.dataset.game+".html"}))}function gamesListSettings(json){let data=JSON.parse(json),games=document.getElementById("gamesList"),gamesTable=[],settings=JSON.parse(localStorage.getItem("game-visibility")||"{}");for(let game in data){let name=data[game].name,state,cbox="";cbox='<input type="checkbox" class="gameState" id="'+game+'" '+(1===(!1===settings[game]?0:1)?"checked":"")+">",gamesTable.push([cbox,name])}let gT=createElement("table",["cardTable",gamesTable]);if(games.appendChild(gT),document.getElementsByClassName("gameState").length>0)for(let i=0;i<document.getElementsByClassName("gameState").length;i++)document.getElementsByClassName("gameState")[i].addEventListener("click",(function(e){app.updateGamesVisibility()}));let cb=document.getElementById("gamesList").querySelectorAll("table.cardTable td:nth-child(1)");for(let i=0;i<cb.length;++i)cb[i].classList.add("text-center")}function gameOverview(md){let data=marked.parse(md),overview=document.getElementById("gameOverview"),card=createElement("div",["card",""]);card.innerHTML=data,overview.appendChild(card)}return{getAppName:function(){return appName},getAppVersion:function(){return appVersion},getAppOwner:function(){return appOwner},createConfirm:function(title,text,button,action){let bodyElement;document.body.insertAdjacentHTML("beforeend",'<div id="dialog-container" class="dialog-container"><div class="dialog"><div class="dialog-title">'+title+'</div><div class="dialog-body">'+text+'</div><div class="dialog-buttons"><button id="dialogConfirm" class="button">'+(button||"OK")+"</button></div></div></div>"),action?document.getElementById("dialogConfirm").addEventListener("click",action):document.getElementById("dialogConfirm").addEventListener("click",(function(){let dialogContainer=document.getElementById("dialog-container");dialogContainer.parentNode.removeChild(dialogContainer)}))},createElement:function(elementType,data){return createElement(elementType,data)},setLoading:function(bool){bool?showLoader():hideLoader()},gameSetting:function(id,type){let settings=JSON.parse(localStorage.getItem(id));if("get"===type&&settings){for(let key in settings.selects)document.getElementById(key).value=settings.selects[key];for(let key in settings.checkboxes)document.getElementById(key).checked=settings.checkboxes[key];for(let key in settings.inputs)document.getElementById(key).value=settings.inputs[key]}if("set"===type){let optionBox=document.getElementById(id),selects=optionBox.getElementsByTagName("select"),inputs=optionBox.getElementsByTagName("input"),newSettings={selects:{},checkboxes:{},inputs:{}};for(let i=0;i<selects.length;i++)newSettings.selects[selects[i].id]=selects[i].value;for(let i=0;i<inputs.length;i++)"checkbox"===inputs[i].type?newSettings.checkboxes[inputs[i].id]=inputs[i].checked:"text"===inputs[i].type&&(newSettings.inputs[inputs[i].id]=inputs[i].value);localStorage.setItem(id,JSON.stringify(newSettings))}},gameInit:function(gameName){loadFile(gameOverview,"../data/g_"+gameName+".md","md")},menuToggle:function(button){let menuBox=document.getElementById("menuBox"),gameOverview=document.getElementById("gameOverview"),gameOption=document.getElementById("gameOption");switch(menuBox.checked=!1,button){case"gameOverview":gameOverview.className="main",gameOption.className="main hidden";break;case"gameOption":gameOverview.className="main hidden",gameOption.className="main"}},arrayShuffle:function(array){for(let i=array.length-1;i>0;i--){let j=Math.floor(Math.random()*(i+1));[array[i],array[j]]=[array[j],array[i]]}return array},getRandomInt:function(min,max){return Math.floor(Math.random()*(max-min+1))+min},init:function(){showLoader(),document.getElementById("copyright").innerHTML=app.getAppName()+", v."+app.getAppVersion()+", &copy; "+app.getAppOwner()+", "+(new Date).getFullYear(),document.getElementById("headerSearch")&&document.getElementById("headerSearch").addEventListener("click",(function(e){let title=document.getElementsByClassName("headerTitle")[0],search=document.getElementsByClassName("headerSearchBox")[0],input=document.getElementById("gameSearch");-1!=title.className.indexOf("display-none")?(title.classList.remove("display-none"),search.classList.add("display-none"),input.value="",input.dispatchEvent(new KeyboardEvent("keyup",{keyCode:70,ctrlKey:!0}))):(title.classList.add("display-none"),search.classList.remove("display-none"),input.focus())})),document.getElementById("gameSearch")&&document.getElementById("gameSearch").addEventListener("keyup",(function(e){let search=document.getElementById("gameSearch").value;if(""!==search)for(let i=0;i<document.getElementsByClassName("cardLogo").length;i++){let gameName;-1===document.getElementsByClassName("cardLogo")[i].dataset.gamename.toUpperCase().indexOf(search.toUpperCase())?document.getElementsByClassName("cardLogo")[i].parentNode.classList.add("display-none"):document.getElementsByClassName("cardLogo")[i].parentNode.classList.remove("display-none")}else for(let i=0;i<document.getElementsByClassName("cardLogo").length;i++)document.getElementsByClassName("cardLogo")[i].parentNode.classList.remove("display-none")})),document.getElementById("games")&&loadFile(registerGames,"../data/g_app.json","json"),document.getElementById("gamesList")&&loadFile(gamesListSettings,"../data/g_app.json","json"),document.getElementById("release-notes")&&loadFile(releaseNotes,"../release-notes.json","json"),document.getElementById("headerBack")&&document.getElementById("headerBack").addEventListener("click",(function(e){location.href=e.target.dataset.url})),"serviceWorker"in navigator&&navigator.serviceWorker.register("../service-worker.js").then((function(registration){setInterval((function(){navigator.serviceWorker.getRegistration().then((function(reg){navigator.onLine&&reg&&reg.update()}))}),36e5),registration.addEventListener("updatefound",()=>{const newWorker=registration.installing;newWorker.addEventListener("statechange",()=>{"installed"===newWorker.state&&navigator.serviceWorker.getRegistration().then((function(reg){reg.waiting&&reg.unregister().then((function(){app.createConfirm("","New version of the application is available. Please click below to update it.","Update",(function(){window.location.reload(!0)}))}))}))})})})),hideLoader()},updateGamesVisibility:function(){let list=document.getElementsByClassName("gameState"),settings={};for(let i=0;i<list.length;i++)settings[list[i].id]=list[i].checked;localStorage.setItem("game-visibility",JSON.stringify(settings))}}}();app.init();
//# sourceMappingURL=app.min.js.map