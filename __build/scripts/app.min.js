"use strict";var app=function(){var appName="Tabletop Helper",appVersion="22.12.28.012221",appOwner="Tomáš 'Stínolez' Vitásek",loader=document.querySelector(".loader");function createElement(elementType,data){var element=document.createElement(elementType);switch(elementType){case"div":case"span":case"tr":case"td":case"li":element.className=data[0],element.innerHTML=data[1];break;case"ul":case"ol":var listData=data[1];element.className=data[0];for(var i=0;i<listData.length;i++){if("cardTable"===listData[i][0])var sub=createElement("table",listData[i]);else var sub=createElement("li",listData[i]);element.appendChild(sub)}break;case"table":var tableData=data[1];element.className=data[0];for(var i=0;i<tableData.length;i++){for(var row=createElement("tr",["",""]),j=0;j<tableData[i].length;j++){var col=createElement("td",["",tableData[i][j]]);row.appendChild(col)}element.appendChild(row)}break;case"img":var imgAttributes=JSON.parse(data[1]);for(var attr in element.className=data[0],imgAttributes)-1===attr.indexOf("data-")?element[attr]=imgAttributes[attr]:element.dataset[attr.replace("data-","")]=imgAttributes[attr]}return element}function showLoader(){loader.hidden=!1}function hideLoader(){loader.hidden=!0}function loadJSON(callback,filepath){var xobj=new XMLHttpRequest;xobj.overrideMimeType("application/json"),xobj.open("GET",filepath,!0),xobj.onreadystatechange=function(){4==xobj.readyState&&"200"==xobj.status&&callback(xobj.responseText)},xobj.send(null)}function releaseNotes(json){var data=JSON.parse(json),rn=document.getElementById("release-notes");for(var versions in data){var card=createElement("div",["card",""]),cardTitle=createElement("div",["cardTitle","Version "+versions+" ("+data[versions].date+")"]),rnList=createElement("ul",["rn",data[versions].rn]);card.appendChild(cardTitle),card.appendChild(rnList),rn.appendChild(card)}}function registerGames(json){var data=JSON.parse(json),games=document.getElementById("games"),settings=JSON.parse(localStorage.getItem("game-visibility")||"{}");for(var game in data)if(!1!==settings[game]){var gameData={src:"images/games-logo/"+game+".png",alt:data[game].name,"data-game":game,"data-gamename":data[game].search},card=createElement("div",["card",""]),img=createElement("img",["cardLogo",JSON.stringify(gameData)]);card.appendChild(img),games.appendChild(card)}if(document.getElementsByClassName("cardLogo").length>0)for(var i=0;i<document.getElementsByClassName("cardLogo").length;i++)document.getElementsByClassName("cardLogo")[i].addEventListener("click",(function(e){location.href="games/g_"+e.srcElement.dataset.game+".html"}))}function gamesListSettings(json){var data=JSON.parse(json),games=document.getElementById("gamesList"),gamesTable=[],settings=JSON.parse(localStorage.getItem("game-visibility")||"{}");for(var game in data){var name=data[game].name,state,cbox="";cbox='<input type="checkbox" class="gameState" id="'+game+'" '+(1===(!1===settings[game]?0:1)?"checked":"")+">",gamesTable.push([cbox,name])}var gT=createElement("table",["cardTable",gamesTable]);if(games.appendChild(gT),document.getElementsByClassName("gameState").length>0)for(var i=0;i<document.getElementsByClassName("gameState").length;i++)document.getElementsByClassName("gameState")[i].addEventListener("click",(function(e){app.updateGamesVisibility()}))}function gameTips(json){var data=JSON.parse(json),tips=document.getElementById("gameTips"),cardT;for(var tip in data.tips){var options=data.tips[tip];"card"===options[0]?(cardT&&tips.appendChild(cardT),cardT=createElement("div",options)):"cardOl"===options[0]?cardT.appendChild(createElement("ol",options)):"cardUl"===options[0]?cardT.appendChild(createElement("ul",options)):"cardTable"===options[0]?cardT.appendChild(createElement("table",options)):cardT.appendChild(createElement("div",options))}tips.appendChild(cardT)}return{getAppName:function(){return appName},getAppVersion:function(){return appVersion},getAppOwner:function(){return appOwner},createConfirm:function(title,text,button,action){var bodyElement;document.body.insertAdjacentHTML("beforeend",'<div id="dialog-container" class="dialog-container"><div class="dialog"><div class="dialog-title">'+title+'</div><div class="dialog-body">'+text+'</div><div class="dialog-buttons"><button id="dialogConfirm" class="button">'+(button||"OK")+"</button></div></div></div>"),action?document.getElementById("dialogConfirm").addEventListener("click",action):document.getElementById("dialogConfirm").addEventListener("click",(function(){var dialogContainer=document.getElementById("dialog-container");dialogContainer.parentNode.removeChild(dialogContainer)}))},createElement:function(elementType,data){return createElement(elementType,data)},setLoading:function(bool){bool?showLoader():hideLoader()},gameSetting:function(id,type){var settings=JSON.parse(localStorage.getItem(id));if("get"===type&&settings){for(var key in console.log(settings),settings.selects)document.getElementById(key).value=settings.selects[key];for(var key in settings.checkboxes)document.getElementById(key).checked=settings.checkboxes[key]}if("set"===type){for(var optionBox=document.getElementById(id),selects=optionBox.getElementsByTagName("select"),inputs=optionBox.getElementsByTagName("input"),newSettings={selects:{},checkboxes:{}},i=0;i<selects.length;i++)newSettings.selects[selects[i].id]=selects[i].value;for(var i=0;i<inputs.length;i++)"checkbox"===inputs[i].type&&(newSettings.checkboxes[inputs[i].id]=inputs[i].checked);localStorage.setItem(id,JSON.stringify(newSettings))}},gameInit:function(gameName){loadJSON(gameTips,"../data/g_"+gameName+".json")},menuToggle:function(button){var menuBox=document.getElementById("menuBox"),gameTips=document.getElementById("gameTips"),gameOption=document.getElementById("gameOption");switch(menuBox.checked=!1,button){case"gameTips":gameTips.className="main",gameOption.className="main hidden";break;case"gameOption":gameTips.className="main hidden",gameOption.className="main"}},arrayShuffle:function(array){for(var i=array.length-1;i>0;i--){var j=Math.floor(Math.random()*(i+1));[array[i],array[j]]=[array[j],array[i]]}return array},init:function(){showLoader(),document.getElementById("copyright").innerHTML=app.getAppName()+", v."+app.getAppVersion()+", &copy; "+app.getAppOwner()+", "+(new Date).getFullYear(),document.getElementById("headerSearch")&&document.getElementById("headerSearch").addEventListener("click",(function(e){var title=document.getElementsByClassName("headerTitle")[0].style.display||"block",search=document.getElementsByClassName("headerSearchBox")[0].style.display||"none";document.getElementsByClassName("headerTitle")[0].style.display="block"===title?"none":"block",document.getElementsByClassName("headerSearchBox")[0].style.display="block"===search?"none":"block","block"===document.getElementsByClassName("headerSearchBox")[0].style.display?document.getElementById("gameSearch").focus():(document.getElementById("gameSearch").value="",document.getElementById("gameSearch").dispatchEvent(new KeyboardEvent("keyup",{keyCode:70,ctrlKey:!0})))})),document.getElementById("gameSearch")&&document.getElementById("gameSearch").addEventListener("keyup",(function(e){var search=document.getElementById("gameSearch").value;if(""!==search)for(var i=0;i<document.getElementsByClassName("cardLogo").length;i++){var gameName;-1===document.getElementsByClassName("cardLogo")[i].dataset.gamename.toUpperCase().indexOf(search.toUpperCase())?document.getElementsByClassName("cardLogo")[i].parentNode.style.display="none":document.getElementsByClassName("cardLogo")[i].parentNode.style.display="block"}else for(var i=0;i<document.getElementsByClassName("cardLogo").length;i++)document.getElementsByClassName("cardLogo")[i].parentNode.style.display="block"})),document.getElementById("games")&&loadJSON(registerGames,"../data/g_app.json"),document.getElementById("gamesList")&&loadJSON(gamesListSettings,"../data/g_app.json"),document.getElementById("release-notes")&&loadJSON(releaseNotes,"../release-notes.json"),document.getElementById("headerBack")&&document.getElementById("headerBack").addEventListener("click",(function(e){location.href=e.srcElement.dataset.url})),"serviceWorker"in navigator&&navigator.serviceWorker.register("../service-worker.js").then((function(registration){setInterval((function(){navigator.serviceWorker.getRegistration().then((function(reg){navigator.onLine&&reg&&reg.update()}))}),36e5),registration.addEventListener("updatefound",()=>{const newWorker=registration.installing;newWorker.addEventListener("statechange",()=>{"installed"===newWorker.state&&navigator.serviceWorker.getRegistration().then((function(reg){reg.waiting&&reg.unregister().then((function(){app.createConfirm("","New version of the application is available. Please click below to update it.","Update",(function(){window.location.reload(!0)}))}))}))})})})),hideLoader()},updateGamesVisibility:function(){for(var list=document.getElementsByClassName("gameState"),settings={},i=0;i<list.length;i++)settings[list[i].id]=list[i].checked;localStorage.setItem("game-visibility",JSON.stringify(settings))}}}();app.init();
//# sourceMappingURL=app.min.js.map